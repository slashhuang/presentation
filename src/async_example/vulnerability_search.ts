const inputElement: HTMLElement|null = document.getElementById('search-input');
const searchPreview: HTMLElement|null = document.getElementById('search-preview');

if (inputElement && searchPreview) {

    // mess up in race condition
    const fetch = (keyWord: string): Promise<string> => {
        let isLater: boolean = keyWord.length%2 === 0;
        if (isLater) {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    resolve(keyWord);
                }, 2000);
            });
        } else {
            return Promise.resolve(keyWord);
        }
    };
    const searchHandler = (event): void => {
        let targetVal: string = event.target.value;
        fetch(targetVal)
        .then((result) => {
            searchPreview.innerHTML = result;
        });
    };

    inputElement.addEventListener('input', searchHandler);
}
